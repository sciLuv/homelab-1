cluster: 
  instances: 1
  initdb:
    database: nextcloud
    owner: nextcloud
    postInitSQL:
      - CREATE EXTENSION IF NOT EXISTS vector;
  storage:
    size: 4Gi

  resources:
    # ressources garanties 
    requests:
      cpu: 250m
      memory: 512Mi
    # ressources maximum  
    limits:
      cpu: 1000m
      memory: 2Gi

  roles: 
    - name: nextcloud
      ensure: present
      comment: Nextcloud Database User
      login: true
      superuser: false
      passwordSecret:
        name: db-nextcloud-user

  postgresql:
    parameters:
      max_connections: "4"
    pg_hba:
      - hostssl all all 10.244.0.0/16 scram-sha-256

backups:
  enabled: true
  provider: s3
  endpointURL: "myminio-hl.minio.svc.cluster.local:9000"
  destinationPath: "s3://cnpg-backups/postgres"

  s3:
    bucket: "cnpg-backups"
    path: "/postgres/"
    region: "us-east-1"
    accessKey: "minio"
    secretKey: "minio123"

  secret:
    create: true
    name: cnpg-backup-creds

  scheduledBackups:
    - name: hourly
      schedule: "0 * * * *"
      method: barmanObjectStore

  